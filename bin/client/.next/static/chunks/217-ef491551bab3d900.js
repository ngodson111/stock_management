"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[217],{831:function(e,t,a){var s=a(2784),n=a(5632),r=a(8039),l=a(5673),i=a(4651),d=a(7897);t.Z=e=>{let{children:t}=e,a=(0,n.useRouter)(),c=(0,r.TL)(),o=(0,r.CG)(e=>e.auth);return((0,s.useEffect)(()=>{a.asPath.indexOf("[")>-1||(o.token&&o.isLoggedIn?c((0,l.c)({})):a.push("/?redirect=".concat(encodeURIComponent(a.asPath))))},[o.token,c,a]),addEventListener("storage",e=>{if(e.key&&0>e.key.indexOf(i.$u))return;let t=e.newValue?JSON.parse(JSON.parse(e.newValue).auth):null;t&&c((0,d.Vp)(t))}),o.token&&o.isLoggedIn)?t:(a.push("/?redirect=".concat(encodeURIComponent(a.asPath))),null)}},3444:function(e,t,a){a.d(t,{Z:function(){return NavBar}});var s=a(2322),n=a(5098),r=a(7897),l=a(342),i=a(8039),d=a(6577),c=a.n(d),o=a(5632);function NavBar(e){let{name:t,showBars:a,back:d}=e,u=(0,o.useRouter)(),m=(0,i.TL)(),h=(0,i.CG)(e=>e.system);return(0,s.jsxs)("div",{className:"navbar",children:[(0,s.jsxs)("div",{className:"navbar-left",children:[d?(0,s.jsx)("i",{className:"fa-regular fa-chevron-left navbar-left--icon__back",onClick:()=>d()}):null,a?(0,s.jsx)("i",{className:"navbar-left--icon__bar fa-light fa-bars",onClick:e=>m((0,l.js)())}):null,(0,s.jsx)("h2",{className:"navbar-left--text",children:t})]}),(0,s.jsx)("div",{className:"navbar-right",children:(0,s.jsxs)("div",{className:"navbar-right",children:[(0,s.jsx)("div",{className:"navbar-right--item",onClick:e=>{m((0,l.Lr)("dark"===h.theme?"light":"dark"))},children:(0,s.jsx)("i",{className:"fa-regular fa-".concat("dark"===h.theme?"moon":"sun-bright")})}),(0,s.jsx)("div",{onClick:e=>{m((0,r.kS)()),u.replace("/")},className:"navbar-right--item navbar-right--item__logout",children:(0,s.jsx)("i",{className:"fa-regular fa-arrow-right-from-bracket"})}),(0,s.jsx)("div",{className:"navbar-right--profile",children:(0,s.jsx)(c(),{src:n.dd,alt:"User profile"})})]})})]})}},3412:function(e,t,a){a.d(t,{Z:function(){return Sidebar},R:function(){return getLogo}});var s=a(2322),n=a(5098),r=a(2480),l=a(342),i=a(8039),d=a(6577),c=a.n(d),o=a(9097),u=a.n(o),m=a(5632),h=a(6698),x=a(9638),f=a(4437),j=a(281),p=a(590),b=a(725),g=a(570),v=a(1383),y=a(4575),A=a(2784),N=a(967),I=a(1044),C=a(2705),k=a(1812),w=a(9803),S=a(9159),q=a(9934);let V=[{name:"title",display:"Title"},{name:"amount",display:"Amount"},{name:"quantity",display:"Quantity"},{name:"subtotal",display:"Sub Total"},{name:"actions",display:"Actions"}];function InsertPurchase(e){let{onClose:t}=e,a=(0,i.TL)(),n=(0,i.CG)(e=>e.system),r=(0,i.CG)(e=>e.vendor),l=(0,i.CG)(e=>e.product),d=(0,i.CG)(e=>e.stock),[c,o]=(0,A.useState)(1),[u,m]=(0,A.useState)(!1),[h,V]=(0,A.useState)(!1),[R,Z]=(0,A.useState)(""),[P,U]=(0,A.useState)(null),[O,_]=(0,A.useState)(new Date),[B,D]=(0,A.useState)({}),handleVendorInsert=()=>a((0,N.jb)(!r.insert)),handleProductInsert=()=>a((0,f.US)(!l.insert));(0,A.useEffect)(()=>{(!l.expires||l.expires&&l.expires-Date.now()<0)&&a((0,j.Xp)())},[l.expires,a]),(0,A.useEffect)(()=>{(!r.expires||r.expires&&r.expires-Date.now()<0)&&a((0,k.wZ)())},[r.expires,a]);let handleBillNumber=e=>{Z(e)},handlePurchaseDate=e=>{let t=new Date(e);t instanceof Date&&_(t)},handleVendorDetails=e=>{let t=r.data.find(t=>t.id===e);if(!t)return(0,x.Iv)("Vendor not found");U(t)},resetItems=()=>{D({}),U(null),m(!1)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.Z,{onClose:t,children:(0,s.jsxs)("div",{className:"purchase-insert fixed",children:[(0,s.jsx)("h2",{className:"purchase-insert--heading",children:"Purchase Bill"}),(0,s.jsxs)("div",{className:"purchase-insert--actions",children:[(0,s.jsx)(p.Z,{label:(0,s.jsxs)("span",{children:[(0,s.jsx)("i",{className:"fa-regular fa-plus"})," Create"]}),type:"primary",style:{minWidth:"10rem"},onClick:()=>V(!0)}),(0,s.jsx)(p.Z,{label:"Reset",type:"error",className:"duotone",style:{minWidth:"10rem"},onClick:()=>m(!0)})]}),(0,s.jsx)("table",{className:"purchase-stock--grid",width:"70%",children:(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Bill Number:"}),(0,s.jsx)("td",{children:(0,s.jsx)(g.Z,{isRequired:!0,id:"billNumber",name:"billNumber",placeholder:"eg. 0005",style:{width:"30rem"},defaultValue:R,onChange:e=>handleBillNumber(e.target.value)})})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Purchase Date:"}),(0,s.jsx)("td",{children:(0,s.jsx)(g.Z,{isRequired:!0,type:"date",id:"date",name:"date",style:{width:"30rem"},defaultValue:(0,I.zM)(O),max:(0,I.zM)(new Date),onChange:e=>handlePurchaseDate(e.target.value)})})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Vendor:"}),(0,s.jsx)("td",{children:(0,s.jsxs)("div",{style:{display:"flex",gap:".3rem",alignItems:"flex-end"},children:[(0,s.jsx)(y.Z,{isRequired:!0,placeholder:"Select Vendor",showSearch:!0,options:r.data.map(e=>({value:e.id,displayValue:"".concat(e.name," (").concat(e.contact,")"),search:"".concat(e.name," ").concat(e.address," ").concat(e.contact)})),style:{width:"30rem"},onChange:e=>handleVendorDetails(e.target.value),defaultValue:null==P?void 0:P.id}),(0,s.jsx)(p.Z,{label:(0,s.jsx)("span",{children:(0,s.jsx)("i",{className:"fa-regular fa-plus"})}),type:"primary",style:{minWidth:"4rem"},onClick:()=>handleVendorInsert()})]})})]})]})}),(0,s.jsx)(CurrentPurchaseBillTable,{data:Object.values(B),products:l.data,addProduct:e=>{let t=l.data.find(t=>t.id===e);if(!t)return(0,x.Iv)("Item not found");let a=B[t.id];a?D(e=>({...e,[t.id]:{...a,quantity:(+a.quantity+1).toString(),subtotal:(+a.amount*(+a.quantity+1)).toString()}})):D(e=>({...e,[t.id]:{amount:t.buyingPrice,quantity:"1",subtotal:t.buyingPrice,title:t.title,productId:t.id,limit:t.quantity}}))},handleProductInsert:handleProductInsert,changeItemAmount:(e,t)=>{let a=B[e];D(s=>({...s,[e]:{...a,amount:t.toString(),subtotal:(t*+a.quantity).toString()}}))},decreaseItemQuantity:e=>{let t=B[e];if(!t||1>=+t.quantity)return;let a=+t.quantity-1;D(s=>({...s,[e]:{...t,quantity:a.toString(),subtotal:(+a*+t.amount).toString()}}))},increaseItemQuantity:(e,t)=>{let a=B[e];if(!a)return;let s=null!=t?t:+a.quantity+1;D(t=>({...t,[e]:{...a,quantity:s.toString(),subtotal:(+s*+a.amount).toString()}}))},removeItem:e=>{D(t=>{let a={...t};return delete a[e],a})}},Object.keys(B).length),(0,s.jsx)("br",{}),(0,s.jsx)("table",{className:"product-stock--grid",width:"70%",children:(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Summery:"}),(0,s.jsx)("td",{})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Sales Date:"}),(0,s.jsx)("td",{children:(0,I.zM)(O)})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Total Amount"}),(0,s.jsxs)("td",{children:["Rs.",Object.values(B).reduce((e,t)=>e=+e+ +t.subtotal,0)," ","(",Object.keys(B).length," Item/s)"]})]}),P&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Vendor"}),(0,s.jsxs)("td",{children:[P.name," (",P.address,")"]})]})]})})]},c)}),l.insert?(0,s.jsx)(C.default,{onClose:handleProductInsert,theme:n.theme}):null,r.insert?(0,s.jsx)(w.default,{onClose:handleVendorInsert}):null,u?(0,s.jsx)(b.Z,{cancel:()=>m(!1),confirm:resetItems,title:"Confirm Reset",message:"Are you sure you want to reset current pruchase?"}):null,h?(0,s.jsx)(b.Z,{cancel:()=>V(!1),confirm:()=>{if(!R)return(0,x.Iv)("Bill number is required");if(!P)return(0,x.Iv)("Please select vendor");if(!O)return(0,x.Iv)("Date is required");if(Object.keys(B).length<1)return(0,x.Iv)("Atlease one item is required");let e=Object.values(B).map(e=>({rate:e.amount.toString(),productId:e.productId,quantity:e.quantity}));a((0,S.QO)({data:{billNumber:R,date:O.toISOString(),products:e,vendorId:P.id},callback:()=>{resetItems(),U(null),Z(""),V(!1),o(e=>e+1),(0,x.Qm)("Purchase bill created"),setTimeout(()=>{a((0,f.Fw)(e.map(e=>({id:e.productId,quantity:+e.quantity}))))},500)}}))},title:"Place Order",message:"Are you sure you want to place purchase order?"}):null,l.loading||l.loading||r.loading||d.loading?(0,s.jsx)(q.Z,{overlay:!0}):null]})}let CurrentPurchaseBillTable=e=>{let{data:t,products:a,addProduct:n,handleProductInsert:r,changeItemAmount:l,decreaseItemQuantity:i,increaseItemQuantity:d,removeItem:c}=e;return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(h.Z,{overflow:"visible",disableControls:!0,headings:V,rawData:[...t.map((e,t)=>({title:{value:e.title},amount:{value:"Rs."+e.amount,display:(0,s.jsx)(g.Z,{style:{width:"10rem"},type:"number",defaultValue:e.amount,onBlur:t=>l(e.productId,+t.target.value)})},quantity:{value:e.quantity,display:(0,s.jsxs)("div",{className:"table-content--actions",children:[(0,s.jsx)(p.Z,{label:(0,s.jsx)("i",{className:"fa-regular fa-minus"}),type:"primary",className:"table-content--actions__btn duotone",onClick:()=>i(e.productId)}),(0,s.jsx)(g.Z,{style:{width:"5rem"},type:"number",defaultValue:e.quantity,onBlur:t=>d(e.productId,+t.target.value)}),(0,s.jsx)(p.Z,{label:(0,s.jsx)("i",{className:"fa-regular fa-plus"}),type:"primary",className:"table-content--actions__btn duotone",onClick:()=>d(e.productId)})]})},subtotal:{value:"Rs."+e.subtotal},actions:{value:"",display:(0,s.jsx)("div",{className:"table-content--actions",children:(0,s.jsx)(p.Z,{label:(0,s.jsx)("i",{className:"fa-regular fa-times"}),type:"error",className:"table-content--actions__btn duotone",onClick:()=>c(e.productId)})})}})),{title:{value:"",display:(0,s.jsxs)("div",{style:{display:"flex",gap:".3rem",alignItems:"flex-end"},children:[(0,s.jsx)(y.Z,{isRequired:!0,placeholder:"Select Product",showSearch:!0,options:a.map(e=>({value:e.id,displayValue:"".concat(e.title," (").concat(e.code,")"),search:"".concat(e.title," ").concat(e.code," ").concat(e.tags)})),style:{width:"30rem"},onChange:e=>n(e.target.value)}),(0,s.jsx)(p.Z,{label:(0,s.jsx)("span",{children:(0,s.jsx)("i",{className:"fa-regular fa-plus"})}),type:"primary",style:{minWidth:"4rem"},onClick:()=>r()})]})},amount:{value:"Rs."+t.reduce((e,t)=>e=+e+ +t.amount,0)},quantity:{value:t.reduce((e,t)=>e=+e+ +t.quantity,0)+" Qty"},subtotal:{value:"Rs."+t.reduce((e,t)=>e=+e+ +t.subtotal,0)},actions:{value:"N/A"}}]})})},R=[{href:"/vendors",title:"Vendors",iconName:"fa-users-rays"},{href:"/members",title:"Members",iconName:"fa-users"},{href:"/stocks",title:"Stocks",iconName:"fa-boxes-stacked"},{href:"/sales",title:"Sales Report",iconName:"fa-file-chart-column"}];function getLogo(e,t){return n.us}function Sidebar(){var e,t;let a=(0,m.useRouter)(),d=(0,i.TL)(),o=(0,i.CG)(e=>e.system),handlePurchase=()=>{d((0,l.QU)(!o.purchase))};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"sidebar",style:{width:o.menu?"15%":"max-content"},children:[(0,s.jsxs)("div",{className:"sidebar-top",children:[(0,s.jsx)("div",{className:"sidebar-top--logo",children:(0,s.jsx)(c(),{src:(o.theme,o.menu,n.us),alt:"Esquare logo",className:"sidebar-top--logo__icon"})}),(0,s.jsxs)("ul",{className:"sidebar-top--menu",children:[(0,s.jsx)(MenuItem,{href:"/dashboard",title:"Home",isActive:"/dashboard"===a.pathname,iconName:"fa-home",showLabel:o.menu}),(0,s.jsx)(MenuItem,{action:handlePurchase,href:"",title:"Create Purchase",isActive:!1,iconName:"fa-file-invoice",showLabel:o.menu}),R.map((e,t)=>(0,s.jsx)(MenuItem,{href:e.href,title:e.title,isActive:a.pathname===e.href,iconName:e.iconName,showLabel:o.menu},t))]})]}),(0,s.jsx)("div",{className:"sidebar-bottom",children:(0,s.jsx)("div",{className:"sidebar-bottom--actions",children:(0,s.jsxs)(u(),{href:"/sales",className:"sidebar-bottom--actions__item",onClick:()=>setTimeout(()=>{d((0,r.US)(!0))},500),children:[(0,s.jsx)("i",{className:"fa-regular fa-plus"}),o.menu?(0,s.jsx)("span",{children:"Create Order"}):null]})})})]}),o.purchase?(0,s.jsx)(InsertPurchase,{onClose:()=>handlePurchase()}):null]})}let MenuItem=e=>{let{href:t,action:a,iconName:n,title:r,isActive:l,showLabel:i}=e;return(0,s.jsx)("li",{className:"sidebar-top--menu__item".concat(l?" active":""," ").concat(i?"open":"close"),children:a?(0,s.jsxs)("span",{onClick:a,title:r,style:{cursor:"pointer"},children:[(0,s.jsx)("i",{className:"fa-solid ".concat(n)}),i?(0,s.jsx)("span",{children:r}):null]}):(0,s.jsxs)(u(),{href:t,title:r,children:[(0,s.jsx)("i",{className:"fa-solid ".concat(n)}),i?(0,s.jsx)("span",{children:r}):null]})})}},5098:function(e,t,a){a.d(t,{dd:function(){return n},us:function(){return s}});var s={src:"/_next/static/media/logo.32536b1a.png",height:286,width:872,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADCAYAAACuyE5IAAAAbklEQVR4nAFjAJz/Afi2UjgEBAML6On79I9d7/oXNgED9A4SzQnp7f8BAQEAAfa1UiAIBwUQ4OH6B51j7AUOMQEF/vsA8wABAfoAAgEBAfe1UyUGBgER3d769KWPAfwPHQAA/Pf8Dv719+kA/v/+1/MrMie6a3wAAAAASUVORK5CYII=",blurWidth:8,blurHeight:3},n={src:"/_next/static/media/dummy-profile.27683932.png",height:300,width:300,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAAAAADhZOFXAAAATUlEQVR42hXKMQ6AIBAF0X//OynswnZqNDGRSGFJqyR0yCpTTh68WOeseAiFUk4S8KJ/G8FErVUvA55bPwwZ9vs5RgGFnFKOhOntuK0fl1U3Nfnv7PMAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},9803:function(e,t,a){a.r(t),a.d(t,{default:function(){return InsertVendor}});var s=a(2322),n=a(566),r=a(9638),l=a(8039),i=a(1812),d=a(1410),c=a(590),o=a(725),u=a(570),m=a(1383),h=a(2784);function InsertVendor(e){let{onClose:t}=e,a=(0,l.TL)(),[x,f]=(0,h.useState)(!1),{error:j,state:p,formKey:b,handleInput:g,handleSubmit:v,resetForm:y}=(0,n.Z)({schema:d.mK}),A=(0,h.useCallback)(()=>{f(e=>!e)},[]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.Z,{onClose:t,children:(0,s.jsxs)("div",{className:"vendor-insert",children:[(0,s.jsx)("h2",{className:"vendor-insert--heading",children:"Insert Vendor"}),(0,s.jsx)("div",{className:"vendor-insert--form",children:(0,s.jsxs)("div",{className:"vendor-insert--form",children:[(0,s.jsx)("h4",{className:"vendor-insert--heading",children:"Basic Information:"}),(0,s.jsx)(u.Z,{id:"name",isRequired:!0,label:"Name",placeholder:"eg. Naran Suppliers..",name:"name",onChange:g,defaultValue:p.name,error:j.name}),(0,s.jsx)(u.Z,{id:"address",isRequired:!0,label:"Address",placeholder:"eg. Kathmandu, Nepal..",name:"address",onChange:g,defaultValue:p.address,error:j.address}),(0,s.jsx)(u.Z,{id:"contact",isRequired:!0,label:"Contact",placeholder:"eg. 98XXXXXXXX or example@..",name:"contact",onChange:g,defaultValue:p.contact,error:j.contact})]})},b),(0,s.jsx)("div",{className:"vendor-insert--actions",children:(0,s.jsx)(c.Z,{label:"Save",type:"primary",onClick:A,style:{minWidth:"13rem"}})})]})}),x?(0,s.jsx)(o.Z,{cancel:A,confirm:()=>{v(e=>{a((0,i.G1)({data:e,callback:()=>{A(),y(),(0,r.Qm)("Vendor inserted")}}))})},title:"Confirm Insert",message:"Are you sure you want to add this item to list?"}):null]})}},1410:function(e,t,a){a.d(t,{LE:function(){return r},mK:function(){return l}});var s=a(195),n=a(3467);let r=s.z.object({id:(0,n.G5)("ID"),name:(0,n.G5)("Name"),address:(0,n.G5)("Address"),contact:(0,n.G5)("Contact"),inserted:(0,n.G5)("Inserted"),updated:(0,n.G5)("Updated")}),l=r.omit({id:!0,inserted:!0,updated:!0});r.pick({id:!0})},9934:function(e,t,a){a.d(t,{Z:function(){return UILoader}});var s=a(2322);function UILoader(e){let{overlay:t}=e;return(0,s.jsxs)("div",{className:"uiloader",children:[t?(0,s.jsx)("div",{className:"uiloader-overlay"}):null,(0,s.jsxs)("div",{className:"uiloader-wrapper",children:[(0,s.jsx)("div",{className:"uiloader-item"}),(0,s.jsx)("div",{className:"uiloader-shadow"})]})]})}}}]);
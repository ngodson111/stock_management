"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[217],{831:function(e,a,t){var s=t(2784),n=t(5632),r=t(8039),l=t(5673),i=t(4651),d=t(7897);a.Z=e=>{let{children:a}=e,t=(0,n.useRouter)(),c=(0,r.TL)(),o=(0,r.CG)(e=>e.auth);return((0,s.useEffect)(()=>{t.asPath.indexOf("[")>-1||(o.token&&o.isLoggedIn?c((0,l.c)({})):t.push("/?redirect=".concat(encodeURIComponent(t.asPath))))},[o.token,c,t]),addEventListener("storage",e=>{if(e.key&&0>e.key.indexOf(i.$u))return;let a=e.newValue?JSON.parse(JSON.parse(e.newValue).auth):null;a&&c((0,d.Vp)(a))}),o.token&&o.isLoggedIn)?a:(t.push("/?redirect=".concat(encodeURIComponent(t.asPath))),null)}},3444:function(e,a,t){t.d(a,{Z:function(){return NavBar}});var s=t(2322),n=t(5098),r=t(7897),l=t(342),i=t(8039),d=t(6577),c=t.n(d),o=t(5632);function NavBar(e){let{name:a,showBars:t,back:d}=e,u=(0,o.useRouter)(),h=(0,i.TL)(),m=(0,i.CG)(e=>e.system);return(0,s.jsxs)("div",{className:"navbar",children:[(0,s.jsxs)("div",{className:"navbar-left",children:[d?(0,s.jsx)("i",{className:"fa-regular fa-chevron-left navbar-left--icon__back",onClick:()=>d()}):null,t?(0,s.jsx)("i",{className:"navbar-left--icon__bar fa-light fa-bars",onClick:e=>h((0,l.js)())}):null,(0,s.jsx)("h2",{className:"navbar-left--text",children:a})]}),(0,s.jsx)("div",{className:"navbar-right",children:(0,s.jsxs)("div",{className:"navbar-right",children:[(0,s.jsx)("div",{className:"navbar-right--item",onClick:e=>{h((0,l.Lr)("dark"===m.theme?"light":"dark"))},children:(0,s.jsx)("i",{className:"fa-regular fa-".concat("dark"===m.theme?"moon":"sun-bright")})}),(0,s.jsx)("div",{onClick:e=>{h((0,r.kS)()),u.replace("/")},className:"navbar-right--item navbar-right--item__logout",children:(0,s.jsx)("i",{className:"fa-regular fa-arrow-right-from-bracket"})}),(0,s.jsx)("div",{className:"navbar-right--profile",children:(0,s.jsx)(c(),{src:n.dd,alt:"User profile"})}),(0,s.jsx)("div",{className:"navbar-right--name",children:"Valid Till: 2025-01-01"})]})})]})}},3412:function(e,a,t){t.d(a,{Z:function(){return Sidebar}});var s=t(2322);t(5098);var n=t(2480),r=t(342),l=t(8039),i=t(9097),d=t.n(i),c=t(5632),o=t(6698),u=t(9638),h=t(4437),m=t(281),x=t(590),j=t(725),f=t(570),p=t(1383),b=t(4575),v=t(2784),g=t(967),y=t(1044),A=t(2705),N=t(1812),I=t(9803),C=t(9159),S=t(9934);let k=[{name:"title",display:"Title"},{name:"amount",display:"Amount"},{name:"quantity",display:"Quantity"},{name:"subtotal",display:"Sub Total"},{name:"actions",display:"Actions"}];function InsertPurchase(e){let{onClose:a}=e,t=(0,l.TL)(),n=(0,l.CG)(e=>e.system),r=(0,l.CG)(e=>e.vendor),i=(0,l.CG)(e=>e.product),d=(0,l.CG)(e=>e.stock),[c,o]=(0,v.useState)(1),[k,w]=(0,v.useState)(!1),[V,q]=(0,v.useState)(!1),[R,Z]=(0,v.useState)(""),[P,U]=(0,v.useState)(null),[O,B]=(0,v.useState)(new Date),[D,_]=(0,v.useState)({}),handleVendorInsert=()=>t((0,g.jb)(!r.insert)),handleProductInsert=()=>t((0,h.US)(!i.insert));(0,v.useEffect)(()=>{(!i.expires||i.expires&&i.expires-Date.now()<0)&&t((0,m.Xp)())},[i.expires,t]),(0,v.useEffect)(()=>{(!r.expires||r.expires&&r.expires-Date.now()<0)&&t((0,N.wZ)())},[r.expires,t]);let handleBillNumber=e=>{Z(e)},handlePurchaseDate=e=>{let a=new Date(e);a instanceof Date&&B(a)},handleVendorDetails=e=>{let a=r.data.find(a=>a.id===e);if(!a)return(0,u.Iv)("Vendor not found");U(a)},resetItems=()=>{_({}),U(null),w(!1)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.Z,{onClose:a,children:(0,s.jsxs)("div",{className:"purchase-insert fixed",children:[(0,s.jsx)("h2",{className:"purchase-insert--heading",children:"Purchase Bill"}),(0,s.jsxs)("div",{className:"purchase-insert--actions",children:[(0,s.jsx)(x.Z,{label:(0,s.jsxs)("span",{children:[(0,s.jsx)("i",{className:"fa-regular fa-plus"})," Create"]}),type:"primary",style:{minWidth:"10rem"},onClick:()=>q(!0)}),(0,s.jsx)(x.Z,{label:"Reset",type:"error",className:"duotone",style:{minWidth:"10rem"},onClick:()=>w(!0)})]}),(0,s.jsx)("table",{className:"purchase-stock--grid",width:"70%",children:(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Bill Number:"}),(0,s.jsx)("td",{children:(0,s.jsx)(f.Z,{isRequired:!0,id:"billNumber",name:"billNumber",placeholder:"eg. 0005",style:{width:"30rem"},defaultValue:R,onChange:e=>handleBillNumber(e.target.value)})})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Purchase Date:"}),(0,s.jsx)("td",{children:(0,s.jsx)(f.Z,{isRequired:!0,type:"date",id:"date",name:"date",style:{width:"30rem"},defaultValue:(0,y.zM)(O),max:(0,y.zM)(new Date),onChange:e=>handlePurchaseDate(e.target.value)})})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Vendor:"}),(0,s.jsx)("td",{children:(0,s.jsxs)("div",{style:{display:"flex",gap:".3rem",alignItems:"flex-end"},children:[(0,s.jsx)(b.Z,{isRequired:!0,placeholder:"Select Vendor",showSearch:!0,options:r.data.map(e=>({value:e.id,displayValue:"".concat(e.name," (").concat(e.contact,")"),search:"".concat(e.name," ").concat(e.address," ").concat(e.contact)})),style:{width:"30rem"},onChange:e=>handleVendorDetails(e.target.value),defaultValue:null==P?void 0:P.id}),(0,s.jsx)(x.Z,{label:(0,s.jsx)("span",{children:(0,s.jsx)("i",{className:"fa-regular fa-plus"})}),type:"primary",style:{minWidth:"4rem"},onClick:()=>handleVendorInsert()})]})})]})]})}),(0,s.jsx)(CurrentPurchaseBillTable,{data:Object.values(D),products:i.data,addProduct:e=>{let a=i.data.find(a=>a.id===e);if(!a)return(0,u.Iv)("Item not found");let t=D[a.id];t?_(e=>({...e,[a.id]:{...t,quantity:(+t.quantity+1).toString(),subtotal:(+t.amount*(+t.quantity+1)).toString()}})):_(e=>({...e,[a.id]:{amount:a.buyingPrice,quantity:"1",subtotal:a.buyingPrice,title:a.title,productId:a.id,limit:a.quantity}}))},handleProductInsert:handleProductInsert,changeItemAmount:(e,a)=>{let t=D[e];_(s=>({...s,[e]:{...t,amount:a.toString(),subtotal:(a*+t.quantity).toString()}}))},decreaseItemQuantity:e=>{let a=D[e];if(!a||1>=+a.quantity)return;let t=+a.quantity-1;_(s=>({...s,[e]:{...a,quantity:t.toString(),subtotal:(+t*+a.amount).toString()}}))},increaseItemQuantity:(e,a)=>{let t=D[e];if(!t)return;let s=null!=a?a:+t.quantity+1;_(a=>({...a,[e]:{...t,quantity:s.toString(),subtotal:(+s*+t.amount).toString()}}))},removeItem:e=>{_(a=>{let t={...a};return delete t[e],t})}},Object.keys(D).length),(0,s.jsx)("br",{}),(0,s.jsx)("table",{className:"product-stock--grid",width:"70%",children:(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Summery:"}),(0,s.jsx)("td",{})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Sales Date:"}),(0,s.jsx)("td",{children:(0,y.zM)(O)})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Total Amount"}),(0,s.jsxs)("td",{children:["Rs.",Object.values(D).reduce((e,a)=>e=+e+ +a.subtotal,0)," ","(",Object.keys(D).length," Item/s)"]})]}),P&&(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Vendor"}),(0,s.jsxs)("td",{children:[P.name," (",P.address,")"]})]})]})})]},c)}),i.insert?(0,s.jsx)(A.default,{onClose:handleProductInsert,theme:n.theme}):null,r.insert?(0,s.jsx)(I.default,{onClose:handleVendorInsert}):null,k?(0,s.jsx)(j.Z,{cancel:()=>w(!1),confirm:resetItems,title:"Confirm Reset",message:"Are you sure you want to reset current pruchase?"}):null,V?(0,s.jsx)(j.Z,{cancel:()=>q(!1),confirm:()=>{if(!R)return(0,u.Iv)("Bill number is required");if(!P)return(0,u.Iv)("Please select vendor");if(!O)return(0,u.Iv)("Date is required");if(Object.keys(D).length<1)return(0,u.Iv)("Atlease one item is required");let e=Object.values(D).map(e=>({rate:e.amount.toString(),productId:e.productId,quantity:e.quantity}));t((0,C.QO)({data:{billNumber:R,date:O.toISOString(),products:e,vendorId:P.id},callback:()=>{resetItems(),U(null),Z(""),q(!1),o(e=>e+1),(0,u.Qm)("Purchase bill created"),setTimeout(()=>{t((0,h.Fw)(e.map(e=>({id:e.productId,quantity:+e.quantity}))))},500)}}))},title:"Place Order",message:"Are you sure you want to place purchase order?"}):null,i.loading||i.loading||r.loading||d.loading?(0,s.jsx)(S.Z,{overlay:!0}):null]})}let CurrentPurchaseBillTable=e=>{let{data:a,products:t,addProduct:n,handleProductInsert:r,changeItemAmount:l,decreaseItemQuantity:i,increaseItemQuantity:d,removeItem:c}=e;return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(o.Z,{overflow:"visible",disableControls:!0,headings:k,rawData:[...a.map((e,a)=>({title:{value:e.title},amount:{value:"Rs."+e.amount,display:(0,s.jsx)(f.Z,{style:{width:"10rem"},type:"number",defaultValue:e.amount,onBlur:a=>l(e.productId,+a.target.value)})},quantity:{value:e.quantity,display:(0,s.jsxs)("div",{className:"table-content--actions",children:[(0,s.jsx)(x.Z,{label:(0,s.jsx)("i",{className:"fa-regular fa-minus"}),type:"primary",className:"table-content--actions__btn duotone",onClick:()=>i(e.productId)}),(0,s.jsx)(f.Z,{style:{width:"5rem"},type:"number",defaultValue:e.quantity,onBlur:a=>d(e.productId,+a.target.value)}),(0,s.jsx)(x.Z,{label:(0,s.jsx)("i",{className:"fa-regular fa-plus"}),type:"primary",className:"table-content--actions__btn duotone",onClick:()=>d(e.productId)})]})},subtotal:{value:"Rs."+e.subtotal},actions:{value:"",display:(0,s.jsx)("div",{className:"table-content--actions",children:(0,s.jsx)(x.Z,{label:(0,s.jsx)("i",{className:"fa-regular fa-times"}),type:"error",className:"table-content--actions__btn duotone",onClick:()=>c(e.productId)})})}})),{title:{value:"",display:(0,s.jsxs)("div",{style:{display:"flex",gap:".3rem",alignItems:"flex-end"},children:[(0,s.jsx)(b.Z,{isRequired:!0,placeholder:"Select Product",showSearch:!0,options:t.map(e=>({value:e.id,displayValue:"".concat(e.title," (").concat(e.code,")"),search:"".concat(e.title," ").concat(e.code," ").concat(e.tags)})),style:{width:"30rem"},onChange:e=>n(e.target.value)}),(0,s.jsx)(x.Z,{label:(0,s.jsx)("span",{children:(0,s.jsx)("i",{className:"fa-regular fa-plus"})}),type:"primary",style:{minWidth:"4rem"},onClick:()=>r()})]})},amount:{value:"Rs."+a.reduce((e,a)=>e=+e+ +a.amount,0)},quantity:{value:a.reduce((e,a)=>e=+e+ +a.quantity,0)+" Qty"},subtotal:{value:"Rs."+a.reduce((e,a)=>e=+e+ +a.subtotal,0)},actions:{value:"N/A"}}]})})},w=[{href:"/vendors",title:"Vendors",iconName:"fa-users-rays"},{href:"/members",title:"Members",iconName:"fa-users"},{href:"/stocks",title:"Stocks",iconName:"fa-boxes-stacked"},{href:"/sales",title:"Sales Report",iconName:"fa-file-chart-column"}];function Sidebar(){let e=(0,c.useRouter)(),a=(0,l.TL)(),t=(0,l.CG)(e=>e.system),handlePurchase=()=>{a((0,r.QU)(!t.purchase))};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"sidebar",style:{width:t.menu?"15%":"max-content"},children:[(0,s.jsxs)("div",{className:"sidebar-top",children:[(0,s.jsx)("div",{className:"sidebar-top--logo",children:(0,s.jsx)("h2",{className:"navbar-right--name",children:"MUUSS ERP"})}),(0,s.jsxs)("ul",{className:"sidebar-top--menu",children:[(0,s.jsx)(MenuItem,{href:"/dashboard",title:"Home",isActive:"/dashboard"===e.pathname,iconName:"fa-home",showLabel:t.menu}),(0,s.jsx)(MenuItem,{action:handlePurchase,href:"",title:"Create Purchase",isActive:!1,iconName:"fa-file-invoice",showLabel:t.menu}),w.map((a,n)=>(0,s.jsx)(MenuItem,{href:a.href,title:a.title,isActive:e.pathname===a.href,iconName:a.iconName,showLabel:t.menu},n))]})]}),(0,s.jsx)("div",{className:"sidebar-bottom",children:(0,s.jsx)("div",{className:"sidebar-bottom--actions",children:(0,s.jsxs)(d(),{href:"/sales",className:"sidebar-bottom--actions__item",onClick:()=>setTimeout(()=>{a((0,n.US)(!0))},500),children:[(0,s.jsx)("i",{className:"fa-regular fa-plus"}),t.menu?(0,s.jsx)("span",{children:"Create Order"}):null]})})})]}),t.purchase?(0,s.jsx)(InsertPurchase,{onClose:()=>handlePurchase()}):null]})}let MenuItem=e=>{let{href:a,action:t,iconName:n,title:r,isActive:l,showLabel:i}=e;return(0,s.jsx)("li",{className:"sidebar-top--menu__item".concat(l?" active":""," ").concat(i?"open":"close"),children:t?(0,s.jsxs)("span",{onClick:t,title:r,style:{cursor:"pointer"},children:[(0,s.jsx)("i",{className:"fa-solid ".concat(n)}),i?(0,s.jsx)("span",{children:r}):null]}):(0,s.jsxs)(d(),{href:a,title:r,children:[(0,s.jsx)("i",{className:"fa-solid ".concat(n)}),i?(0,s.jsx)("span",{children:r}):null]})})}},5098:function(e,a,t){t.d(a,{dd:function(){return n},us:function(){return s}});var s={src:"/_next/static/media/logo.32536b1a.png",height:286,width:872,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADCAYAAACuyE5IAAAAbklEQVR4nAFjAJz/Afi2UjgEBAML6On79I9d7/oXNgED9A4SzQnp7f8BAQEAAfa1UiAIBwUQ4OH6B51j7AUOMQEF/vsA8wABAfoAAgEBAfe1UyUGBgER3d769KWPAfwPHQAA/Pf8Dv719+kA/v/+1/MrMie6a3wAAAAASUVORK5CYII=",blurWidth:8,blurHeight:3},n={src:"/_next/static/media/dummy-profile.27683932.png",height:300,width:300,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAAAAADhZOFXAAAATUlEQVR42hXKMQ6AIBAF0X//OynswnZqNDGRSGFJqyR0yCpTTh68WOeseAiFUk4S8KJ/G8FErVUvA55bPwwZ9vs5RgGFnFKOhOntuK0fl1U3Nfnv7PMAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8}},9803:function(e,a,t){t.r(a),t.d(a,{default:function(){return InsertVendor}});var s=t(2322),n=t(566),r=t(9638),l=t(8039),i=t(1812),d=t(1410),c=t(590),o=t(725),u=t(570),h=t(1383),m=t(2784);function InsertVendor(e){let{onClose:a}=e,t=(0,l.TL)(),[x,j]=(0,m.useState)(!1),{error:f,state:p,formKey:b,handleInput:v,handleSubmit:g,resetForm:y}=(0,n.Z)({schema:d.mK}),A=(0,m.useCallback)(()=>{j(e=>!e)},[]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{onClose:a,children:(0,s.jsxs)("div",{className:"vendor-insert",children:[(0,s.jsx)("h2",{className:"vendor-insert--heading",children:"Insert Vendor"}),(0,s.jsx)("div",{className:"vendor-insert--form",children:(0,s.jsxs)("div",{className:"vendor-insert--form",children:[(0,s.jsx)("h4",{className:"vendor-insert--heading",children:"Basic Information:"}),(0,s.jsx)(u.Z,{id:"name",isRequired:!0,label:"Name",placeholder:"eg. Naran Suppliers..",name:"name",onChange:v,defaultValue:p.name,error:f.name}),(0,s.jsx)(u.Z,{id:"address",isRequired:!0,label:"Address",placeholder:"eg. Kathmandu, Nepal..",name:"address",onChange:v,defaultValue:p.address,error:f.address}),(0,s.jsx)(u.Z,{id:"contact",isRequired:!0,label:"Contact",placeholder:"eg. 98XXXXXXXX or example@..",name:"contact",onChange:v,defaultValue:p.contact,error:f.contact})]})},b),(0,s.jsx)("div",{className:"vendor-insert--actions",children:(0,s.jsx)(c.Z,{label:"Save",type:"primary",onClick:A,style:{minWidth:"13rem"}})})]})}),x?(0,s.jsx)(o.Z,{cancel:A,confirm:()=>{g(e=>{t((0,i.G1)({data:e,callback:()=>{A(),y(),(0,r.Qm)("Vendor inserted")}}))})},title:"Confirm Insert",message:"Are you sure you want to add this item to list?"}):null]})}},1410:function(e,a,t){t.d(a,{LE:function(){return r},mK:function(){return l}});var s=t(195),n=t(3467);let r=s.z.object({id:(0,n.G5)("ID"),name:(0,n.G5)("Name"),address:(0,n.G5)("Address"),contact:(0,n.G5)("Contact"),inserted:(0,n.G5)("Inserted"),updated:(0,n.G5)("Updated")}),l=r.omit({id:!0,inserted:!0,updated:!0});r.pick({id:!0})},9934:function(e,a,t){t.d(a,{Z:function(){return UILoader}});var s=t(2322);function UILoader(e){let{overlay:a}=e;return(0,s.jsxs)("div",{className:"uiloader",children:[a?(0,s.jsx)("div",{className:"uiloader-overlay"}):null,(0,s.jsxs)("div",{className:"uiloader-wrapper",children:[(0,s.jsx)("div",{className:"uiloader-item"}),(0,s.jsx)("div",{className:"uiloader-shadow"})]})]})}}}]);
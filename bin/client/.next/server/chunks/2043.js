"use strict";exports.id=2043,exports.ids=[2043],exports.modules={831:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var l=a(6689),r=a(5632),n=a(1045),i=a(5673),d=a(4651),c=a(7897),u=e([n,i,c]);[n,i,c]=u.then?(await u)():u;let __WEBPACK_DEFAULT_EXPORT__=({children:e})=>{let t=(0,r.useRouter)(),a=(0,n.TL)(),s=(0,n.CG)(e=>e.auth);return((0,l.useEffect)(()=>{t.asPath.indexOf("[")>-1||(s.token&&s.isLoggedIn?a((0,i.c)({})):t.push(`/?redirect=${encodeURIComponent(t.asPath)}`))},[s.token,a,t]),addEventListener("storage",e=>{if(e.key&&0>e.key.indexOf(d.$u))return;let t=e.newValue?JSON.parse(JSON.parse(e.newValue).auth):null;t&&a((0,c.Vp)(t))}),s.token&&s.isLoggedIn)?e:(t.push(`/?redirect=${encodeURIComponent(t.asPath)}`),null)};s()}catch(e){s(e)}})},3444:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{Z:()=>NavBar});var l=a(997),r=a(5098),n=a(7897),i=a(342),d=a(1045),c=a(6577),u=a.n(c),o=a(5632),h=e([n,d]);function NavBar({name:e,showBars:t,back:a}){let s=(0,o.useRouter)(),c=(0,d.TL)(),h=(0,d.CG)(e=>e.system);return(0,l.jsxs)("div",{className:"navbar",children:[(0,l.jsxs)("div",{className:"navbar-left",children:[a?l.jsx("i",{className:"fa-regular fa-chevron-left navbar-left--icon__back",onClick:()=>a()}):null,t?l.jsx("i",{className:"navbar-left--icon__bar fa-light fa-bars",onClick:e=>c((0,i.js)())}):null,l.jsx("h2",{className:"navbar-left--text",children:e})]}),l.jsx("div",{className:"navbar-right",children:(0,l.jsxs)("div",{className:"navbar-right",children:[l.jsx("div",{className:"navbar-right--item",onClick:e=>{c((0,i.Lr)("dark"===h.theme?"light":"dark"))},children:l.jsx("i",{className:`fa-regular fa-${"dark"===h.theme?"moon":"sun-bright"}`})}),l.jsx("div",{onClick:e=>{c((0,n.kS)()),s.replace("/")},className:"navbar-right--item navbar-right--item__logout",children:l.jsx("i",{className:"fa-regular fa-arrow-right-from-bracket"})}),l.jsx("div",{className:"navbar-right--profile",children:l.jsx(u(),{src:r.dd,alt:"User profile"})})]})})]})}[n,d]=h.then?(await h)():h,s()}catch(e){s(e)}})},3141:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{Z:()=>InsertPurchase});var l=a(997),r=a(6698),n=a(9638),i=a(4437),d=a(1045),c=a(281),u=a(590),o=a(725),h=a(570),m=a(1383),x=a(4575),j=a(6689),p=a(967),b=a(1044),y=a(2705),f=a(1812),g=a(9803),v=a(9159),N=a(9934),I=e([n,i,d,c,p,b,y,f,g,v]);[n,i,d,c,p,b,y,f,g,v]=I.then?(await I)():I;let C=[{name:"title",display:"Title"},{name:"amount",display:"Amount"},{name:"quantity",display:"Quantity"},{name:"subtotal",display:"Sub Total"},{name:"actions",display:"Actions"}];function InsertPurchase({onClose:e}){let t=(0,d.TL)(),a=(0,d.CG)(e=>e.system),s=(0,d.CG)(e=>e.vendor),r=(0,d.CG)(e=>e.product),I=(0,d.CG)(e=>e.stock),[C,k]=(0,j.useState)(1),[S,w]=(0,j.useState)(!1),[P,_]=(0,j.useState)(!1),[q,Z]=(0,j.useState)(""),[R,V]=(0,j.useState)(null),[$,D]=(0,j.useState)(new Date),[O,A]=(0,j.useState)({}),handleVendorInsert=()=>t((0,p.jb)(!s.insert)),handleProductInsert=()=>t((0,i.US)(!r.insert));(0,j.useEffect)(()=>{(!r.expires||r.expires&&r.expires-Date.now()<0)&&t((0,c.Xp)())},[r.expires,t]),(0,j.useEffect)(()=>{(!s.expires||s.expires&&s.expires-Date.now()<0)&&t((0,f.wZ)())},[s.expires,t]);let handleBillNumber=e=>{Z(e)},handlePurchaseDate=e=>{let t=new Date(e);t instanceof Date&&D(t)},handleVendorDetails=e=>{let t=s.data.find(t=>t.id===e);if(!t)return(0,n.Iv)("Vendor not found");V(t)},resetItems=()=>{A({}),V(null),w(!1)};return(0,l.jsxs)(l.Fragment,{children:[l.jsx(m.Z,{onClose:e,children:(0,l.jsxs)("div",{className:"purchase-insert fixed",children:[l.jsx("h2",{className:"purchase-insert--heading",children:"Purchase Bill"}),(0,l.jsxs)("div",{className:"purchase-insert--actions",children:[l.jsx(u.Z,{label:(0,l.jsxs)("span",{children:[l.jsx("i",{className:"fa-regular fa-plus"})," Create"]}),type:"primary",style:{minWidth:"10rem"},onClick:()=>_(!0)}),l.jsx(u.Z,{label:"Reset",type:"error",className:"duotone",style:{minWidth:"10rem"},onClick:()=>w(!0)})]}),l.jsx("table",{className:"purchase-stock--grid",width:"70%",children:(0,l.jsxs)("tbody",{children:[(0,l.jsxs)("tr",{children:[l.jsx("th",{children:"Bill Number:"}),l.jsx("td",{children:l.jsx(h.Z,{isRequired:!0,id:"billNumber",name:"billNumber",placeholder:"eg. 0005",style:{width:"30rem"},defaultValue:q,onChange:e=>handleBillNumber(e.target.value)})})]}),(0,l.jsxs)("tr",{children:[l.jsx("th",{children:"Purchase Date:"}),l.jsx("td",{children:l.jsx(h.Z,{isRequired:!0,type:"date",id:"date",name:"date",style:{width:"30rem"},defaultValue:(0,b.zM)($),max:(0,b.zM)(new Date),onChange:e=>handlePurchaseDate(e.target.value)})})]}),(0,l.jsxs)("tr",{children:[l.jsx("th",{children:"Vendor:"}),l.jsx("td",{children:(0,l.jsxs)("div",{style:{display:"flex",gap:".3rem",alignItems:"flex-end"},children:[l.jsx(x.Z,{isRequired:!0,placeholder:"Select Vendor",showSearch:!0,options:s.data.map(e=>({value:e.id,displayValue:`${e.name} (${e.contact})`,search:`${e.name} ${e.address} ${e.contact}`})),style:{width:"30rem"},onChange:e=>handleVendorDetails(e.target.value),defaultValue:R?.id}),l.jsx(u.Z,{label:l.jsx("span",{children:l.jsx("i",{className:"fa-regular fa-plus"})}),type:"primary",style:{minWidth:"4rem"},onClick:()=>handleVendorInsert()})]})})]})]})}),l.jsx(CurrentPurchaseBillTable,{data:Object.values(O),products:r.data,addProduct:e=>{let t=r.data.find(t=>t.id===e);if(!t)return(0,n.Iv)("Item not found");let a=O[t.id];a?A(e=>({...e,[t.id]:{...a,quantity:(+a.quantity+1).toString(),subtotal:(+a.amount*(+a.quantity+1)).toString()}})):A(e=>({...e,[t.id]:{amount:t.buyingPrice,quantity:"1",subtotal:t.buyingPrice,title:t.title,productId:t.id,limit:t.quantity}}))},handleProductInsert:handleProductInsert,changeItemAmount:(e,t)=>{let a=O[e];A(s=>({...s,[e]:{...a,amount:t.toString(),subtotal:(t*+a.quantity).toString()}}))},decreaseItemQuantity:e=>{let t=O[e];if(!t||1>=+t.quantity)return;let a=+t.quantity-1;A(s=>({...s,[e]:{...t,quantity:a.toString(),subtotal:(+a*+t.amount).toString()}}))},increaseItemQuantity:(e,t)=>{let a=O[e];if(!a)return;let s=t??+a.quantity+1;A(t=>({...t,[e]:{...a,quantity:s.toString(),subtotal:(+s*+a.amount).toString()}}))},removeItem:e=>{A(t=>{let a={...t};return delete a[e],a})}},Object.keys(O).length),l.jsx("br",{}),l.jsx("table",{className:"product-stock--grid",width:"70%",children:(0,l.jsxs)("tbody",{children:[(0,l.jsxs)("tr",{children:[l.jsx("th",{children:"Summery:"}),l.jsx("td",{})]}),(0,l.jsxs)("tr",{children:[l.jsx("th",{children:"Sales Date:"}),l.jsx("td",{children:(0,b.zM)($)})]}),(0,l.jsxs)("tr",{children:[l.jsx("th",{children:"Total Amount"}),(0,l.jsxs)("td",{children:["Rs.",Object.values(O).reduce((e,t)=>e=+e+ +t.subtotal,0)," ","(",Object.keys(O).length," Item/s)"]})]}),R&&(0,l.jsxs)("tr",{children:[l.jsx("th",{children:"Vendor"}),(0,l.jsxs)("td",{children:[R.name," (",R.address,")"]})]})]})})]},C)}),r.insert?l.jsx(y.default,{onClose:handleProductInsert,theme:a.theme}):null,s.insert?l.jsx(g.default,{onClose:handleVendorInsert}):null,S?l.jsx(o.Z,{cancel:()=>w(!1),confirm:resetItems,title:"Confirm Reset",message:"Are you sure you want to reset current pruchase?"}):null,P?l.jsx(o.Z,{cancel:()=>_(!1),confirm:()=>{if(!q)return(0,n.Iv)("Bill number is required");if(!R)return(0,n.Iv)("Please select vendor");if(!$)return(0,n.Iv)("Date is required");if(Object.keys(O).length<1)return(0,n.Iv)("Atlease one item is required");let e=Object.values(O).map(e=>({rate:e.amount.toString(),productId:e.productId,quantity:e.quantity}));t((0,v.QO)({data:{billNumber:q,date:$.toISOString(),products:e,vendorId:R.id},callback:()=>{resetItems(),V(null),Z(""),_(!1),k(e=>e+1),(0,n.Qm)("Purchase bill created"),setTimeout(()=>{t((0,i.Fw)(e.map(e=>({id:e.productId,quantity:+e.quantity}))))},500)}}))},title:"Place Order",message:"Are you sure you want to place purchase order?"}):null,r.loading||r.loading||s.loading||I.loading?l.jsx(N.Z,{overlay:!0}):null]})}let CurrentPurchaseBillTable=({data:e,products:t,addProduct:a,handleProductInsert:s,changeItemAmount:n,decreaseItemQuantity:i,increaseItemQuantity:d,removeItem:c})=>l.jsx(l.Fragment,{children:l.jsx(r.Z,{overflow:"visible",disableControls:!0,headings:C,rawData:[...e.map((e,t)=>({title:{value:e.title},amount:{value:"Rs."+e.amount,display:l.jsx(h.Z,{style:{width:"10rem"},type:"number",defaultValue:e.amount,onBlur:t=>n(e.productId,+t.target.value)})},quantity:{value:e.quantity,display:(0,l.jsxs)("div",{className:"table-content--actions",children:[l.jsx(u.Z,{label:l.jsx("i",{className:"fa-regular fa-minus"}),type:"primary",className:"table-content--actions__btn duotone",onClick:()=>i(e.productId)}),l.jsx(h.Z,{style:{width:"5rem"},type:"number",defaultValue:e.quantity,onBlur:t=>d(e.productId,+t.target.value)}),l.jsx(u.Z,{label:l.jsx("i",{className:"fa-regular fa-plus"}),type:"primary",className:"table-content--actions__btn duotone",onClick:()=>d(e.productId)})]})},subtotal:{value:"Rs."+e.subtotal},actions:{value:"",display:l.jsx("div",{className:"table-content--actions",children:l.jsx(u.Z,{label:l.jsx("i",{className:"fa-regular fa-times"}),type:"error",className:"table-content--actions__btn duotone",onClick:()=>c(e.productId)})})}})),{title:{value:"",display:(0,l.jsxs)("div",{style:{display:"flex",gap:".3rem",alignItems:"flex-end"},children:[l.jsx(x.Z,{isRequired:!0,placeholder:"Select Product",showSearch:!0,options:t.map(e=>({value:e.id,displayValue:`${e.title} (${e.code})`,search:`${e.title} ${e.code} ${e.tags}`})),style:{width:"30rem"},onChange:e=>a(e.target.value)}),l.jsx(u.Z,{label:l.jsx("span",{children:l.jsx("i",{className:"fa-regular fa-plus"})}),type:"primary",style:{minWidth:"4rem"},onClick:()=>s()})]})},amount:{value:"Rs."+e.reduce((e,t)=>e=+e+ +t.amount,0)},quantity:{value:e.reduce((e,t)=>e=+e+ +t.quantity,0)+" Qty"},subtotal:{value:"Rs."+e.reduce((e,t)=>e=+e+ +t.subtotal,0)},actions:{value:"N/A"}}]})});s()}catch(e){s(e)}})},4101:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.d(t,{R:()=>getLogo,Z:()=>Sidebar});var l=a(997),r=a(5098),n=a(2480),i=a(342),d=a(1045),c=a(6577),u=a.n(c),o=a(9097),h=a.n(o),m=a(5632),x=a(3141),j=e([n,d,x]);[n,d,x]=j.then?(await j)():j;let p=[{href:"/vendors",title:"Vendors",iconName:"fa-users-rays"},{href:"/members",title:"Members",iconName:"fa-users"},{href:"/stocks",title:"Stocks",iconName:"fa-boxes-stacked"},{href:"/sales",title:"Sales Report",iconName:"fa-file-chart-column"}];function getLogo(e,t){return r.us}function Sidebar(){var e,t;let a=(0,m.useRouter)(),s=(0,d.TL)(),c=(0,d.CG)(e=>e.system),handlePurchase=()=>{s((0,i.QU)(!c.purchase))};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"sidebar",style:{width:c.menu?"15%":"max-content"},children:[(0,l.jsxs)("div",{className:"sidebar-top",children:[l.jsx("div",{className:"sidebar-top--logo",children:l.jsx(u(),{src:(c.theme,c.menu,r.us),alt:"Esquare logo",className:"sidebar-top--logo__icon"})}),(0,l.jsxs)("ul",{className:"sidebar-top--menu",children:[l.jsx(MenuItem,{href:"/dashboard",title:"Home",isActive:"/dashboard"===a.pathname,iconName:"fa-home",showLabel:c.menu}),l.jsx(MenuItem,{action:handlePurchase,href:"",title:"Create Purchase",isActive:!1,iconName:"fa-file-invoice",showLabel:c.menu}),p.map((e,t)=>l.jsx(MenuItem,{href:e.href,title:e.title,isActive:a.pathname===e.href,iconName:e.iconName,showLabel:c.menu},t))]})]}),l.jsx("div",{className:"sidebar-bottom",children:l.jsx("div",{className:"sidebar-bottom--actions",children:(0,l.jsxs)(h(),{href:"/sales",className:"sidebar-bottom--actions__item",onClick:()=>setTimeout(()=>{s((0,n.US)(!0))},500),children:[l.jsx("i",{className:"fa-regular fa-plus"}),c.menu?l.jsx("span",{children:"Create Order"}):null]})})})]}),c.purchase?l.jsx(x.Z,{onClose:()=>handlePurchase()}):null]})}let MenuItem=({href:e,action:t,iconName:a,title:s,isActive:r,showLabel:n})=>l.jsx("li",{className:`sidebar-top--menu__item${r?" active":""} ${n?"open":"close"}`,children:t?(0,l.jsxs)("span",{onClick:t,title:s,style:{cursor:"pointer"},children:[l.jsx("i",{className:`fa-solid ${a}`}),n?l.jsx("span",{children:s}):null]}):(0,l.jsxs)(h(),{href:e,title:s,children:[l.jsx("i",{className:`fa-solid ${a}`}),n?l.jsx("span",{children:s}):null]})});s()}catch(e){s(e)}})}};